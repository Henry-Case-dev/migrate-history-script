# üéØ –ú–∏–≥—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤ - –ì–û–¢–û–í–û –ö –ó–ê–ü–£–°–ö–£

## ‚úÖ –°—Ç–∞—Ç—É—Å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

–°–µ—Ä–≤–∏—Å –º–∏–≥—Ä–∞—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è Windows-—Å–µ—Ä–≤–µ—Ä–∞ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏:

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ **–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–∫—Ä–∏–ø—Ç–∞
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ .env** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ .env —Ñ–∞–π–ª–∞
- ‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** - migration_state.json –¥–ª—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π** - JSON —Ñ–∞–π–ª—ã –≤ migrate_history/data/
- ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ Ctrl+C

### üìÅ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
cmd/migrate_history/
‚îú‚îÄ‚îÄ main.go                  # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test_setup.go           # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ run_migration.sh        # –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env                    # –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ migration_state.json    # –°–æ—Å—Ç–æ—è–Ω–∏–µ (–∞–≤—Ç–æ—Å–æ–∑–¥–∞–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ migration.log          # –õ–æ–≥–∏ (–∞–≤—Ç–æ—Å–æ–∑–¥–∞–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ migrate_history.exe     # –°–æ–±—Ä–∞–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ data/                   # JSON —Ñ–∞–π–ª—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ (3 —Ñ–∞–π–ª–∞, 574 –ú–ë)
‚îÇ   ‚îú‚îÄ‚îÄ 10.08.2025.json
‚îÇ   ‚îú‚îÄ‚îÄ 10.2024.json
‚îÇ   ‚îî‚îÄ‚îÄ –∂–µ–ª—Ç–∞—è –¥–æ 10.2024.json
‚îú‚îÄ‚îÄ cache/                  # –ö—ç—à —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (–∞–≤—Ç–æ—Å–æ–∑–¥–∞–µ—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ embeddings/
‚îî‚îÄ‚îÄ tools/                  # –£—Ç–∏–ª–∏—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –ë–î
    ‚îú‚îÄ‚îÄ calculate_db_size.go
    ‚îî‚îÄ‚îÄ detailed_db_analysis.go
```

### üöÄ –°–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞

#### 1. –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
cd cmd/migrate_history
bash run_migration.sh
# –í—ã–±–æ—Ä: 1=—Ç–µ—Å—Ç, 2=—Å–±–æ—Ä–∫–∞, 3=–∑–∞–ø—É—Å–∫, 4=—Å–±–æ—Ä–∫–∞+–∑–∞–ø—É—Å–∫
```

#### 2. –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫:
```bash
cd cmd/migrate_history
go run main.go                    # –ß–µ—Ä–µ–∑ Go
./migrate_history.exe            # –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
```

#### 3. –§–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º:
```bash
cd cmd/migrate_history
nohup ./migrate_history.exe > migration.log 2>&1 &
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

#### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```bash
tail -f migration.log
```

#### –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
cat migration_state.json
```

#### –ü—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤ –ª–æ–≥–∞—Ö:
- `üìä [Progress]` - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–æ—Ü–µ–Ω—Ç, —Å–∫–æ—Ä–æ—Å—Ç—å
- `‚è±Ô∏è [Progress]` - –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è, API –ª–∏–º–∏—Ç—ã
- `‚úÖ` - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `‚ùå [ERROR]` - –æ—à–∏–±–∫–∏
- `‚ö†Ô∏è` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–ö–æ–º–∞–Ω–¥–∞**: `go run test_setup.go`

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–µ—Å—Ç–∞**:
- ‚úÖ PostgreSQL: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ (46.19.69.26:5432)
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ JSON —Ñ–∞–π–ª—ã: –Ω–∞–π–¥–µ–Ω–æ 3 —Ñ–∞–π–ª–∞ (574 –ú–ë)
- ‚ùå Gemini API: –∫–ª—é—á –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (.env)
```bash
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
EMBEDDING_REQUESTS_PER_MINUTE=240
EMBEDDING_REQUESTS_PER_DAY=24000
EMBEDDING_REQUEST_DELAY=300ms
```

### üõ°Ô∏è –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º
- **–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** –∫–∞–∂–¥—ã–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π
- **–í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —Å –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã** API —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤** –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ API –≤—ã–∑–æ–≤–æ–≤

### üìà –û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–°–∫–æ—Ä–æ—Å—Ç—å**: 20-50 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: ~8-12 —á–∞—Å–æ–≤ –¥–ª—è 3 —Ñ–∞–π–ª–æ–≤ (574 –ú–ë)
- **–°—Ç–æ–∏–º–æ—Å—Ç—å API**: ~$10-15 –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–û–±–Ω–æ–≤–∏—Ç—å Gemini API –∫–ª—é—á** –≤ .env —Ñ–∞–π–ª–µ
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `go run test_setup.go`
3. **–ù–∞—á–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é**: `bash run_migration.sh` ‚Üí –≤—ã–±–æ—Ä 4
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å**: `tail -f migration.log`

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `tail -50 migration.log`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `cat migration_state.json`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (Ctrl+C) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞
4. –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `rm migration_state.json cache/ -rf`

---
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–û–¢–û–í –ö –ó–ê–ü–£–°–ö–£  
**–î–∞—Ç–∞**: 21.09.2025  
**–í–µ—Ä—Å–∏—è**: 2.0 (Windows-–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)